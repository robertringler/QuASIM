# Defense-Grade Compliance Configuration
# QuASIM Aerospace & Defense Compliance Framework

version: "1.0"
project:
  name: "QuASIM"
  classification: "CUI"  # Controlled Unclassified Information
  mission_critical: true
  safety_level: "DO-178C Level A"

# Compliance Frameworks
frameworks:
  nist_800_53:
    enabled: true
    baseline: "HIGH"
    revision: "Rev 5"
    control_families:
      - AC  # Access Control
      - AU  # Audit and Accountability
      - CM  # Configuration Management
      - IA  # Identification and Authentication
      - SC  # System and Communications Protection
      - SI  # System and Information Integrity
      - SA  # System and Services Acquisition

  nist_800_171:
    enabled: true
    revision: "R3"
    cui_protection: true
    assessment_required: true

  cmmc:
    enabled: true
    level: 2  # CMMC Level 2
    certification_required: true
    assessment_scope: "full_system"

  dfars:
    enabled: true
    clauses:
      - "252.204-7012"  # Safeguarding Covered Defense Information
      - "252.204-7019"  # Notice of NIST SP 800-171 DoD Assessment
      - "252.204-7020"  # NIST SP 800-171 DoD Assessment Requirements

  fips:
    enabled: true
    fips_140_3: true
    cryptographic_modules:
      - "OpenSSL 3.0 FIPS"
    validated_algorithms:
      - "AES-256"
      - "SHA-256"
      - "RSA-2048"

  itar:
    enabled: true
    usml_categories: ["VIII", "XI", "XV"]
    export_controlled: true
    foreign_person_access: false

  ear:
    enabled: true
    eccn_classification: "5D002"  # Software for development or production
    license_exception: "TSU"

  do_178c:
    enabled: true
    level: "A"  # Highest criticality
    dal: "Level A"
    coverage_requirements:
      mcdc: 100
      statement: 100
      branch: 100

  soc2:
    enabled: true
    type: "Type II"
    trust_services:
      - "Security"
      - "Availability"
      - "Confidentiality"

  iso_27001:
    enabled: true
    version: "2022"
    certification_required: false

# Security Controls
security:
  encryption:
    at_rest: true
    in_transit: true
    algorithm: "AES-256-GCM"
    key_management: "FIPS 140-3"

  access_control:
    mfa_required: true
    rbac_enabled: true
    least_privilege: true
    session_timeout: 900  # 15 minutes

  audit:
    logging_level: "detailed"
    log_retention_days: 2555  # 7 years
    tamper_protection: true
    siem_integration: true

  vulnerability_management:
    scanning_frequency: "daily"
    patch_sla_critical: 15  # days
    patch_sla_high: 30
    patch_sla_medium: 90

# Code Quality Standards
code_quality:
  linting:
    ruff_enabled: true
    pylint_enabled: true
    min_score: 9.0

  formatting:
    black_enabled: true
    line_length: 100
    isort_enabled: true

  type_checking:
    mypy_enabled: true
    strict_mode: true

  testing:
    min_coverage: 85
    mutation_testing: true
    fuzz_testing: true

  static_analysis:
    bandit_enabled: true
    semgrep_enabled: true
    codeql_enabled: true

# Supply Chain Security
supply_chain:
  sbom:
    format: "SPDX 2.3"
    generation: "automatic"
    verification: true

  dependency_scanning:
    enabled: true
    tools:
      - "pip-audit"
      - "safety"
      - "snyk"

  vendor_validation:
    approved_vendors_only: true
    section_889_compliance: true
    source_verification: true

  provenance:
    slsa_level: 3
    build_attestation: true
    signature_verification: true

# Export Control
export_control:
  screening_required: true
  license_tracking: true
  end_user_validation: true
  sanctioned_countries:
    - "CU"  # Cuba
    - "IR"  # Iran
    - "KP"  # North Korea
    - "SY"  # Syria
    - "RU"  # Russia (partial)
    - "BY"  # Belarus

# Continuous Monitoring
monitoring:
  runtime_protection: true
  anomaly_detection: true
  threat_intelligence: true
  incident_response_plan: true

# Documentation Requirements
documentation:
  architecture_diagrams: required
  security_plans: required
  risk_assessments: required
  incident_reports: required
  compliance_matrices: required
  test_reports: required

# Reporting
reporting:
  frequency: "monthly"
  stakeholders:
    - "CISO"
    - "Compliance Officer"
    - "Program Manager"
  formats:
    - "PDF"
    - "CSV"
    - "JSON"

# Remediation
remediation:
  sla_critical: 7  # days
  sla_high: 30
  sla_medium: 90
  sla_low: 180
  escalation_enabled: true
  auto_ticket_creation: true
